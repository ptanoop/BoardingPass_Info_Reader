<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8"/>
		<title>Explain Boarding Pass Resolution 792</title>
		<!-- Modernizr -->
		<script type="text/javascript" src="js_libs/jquery-1.10.2.min.js"></script>	
		<script type="text/javascript" src="js_libs/modernizr-2.6.2.min.js"></script>	
		<script type="text/javascript" src="js_libs/groundwork.all.js"></script>	
		<script type="text/javascript" src="boarding_pass_parser.js"></script>
		<script type="text/javascript" src="js_libs/moment.min.js"></script>
		<script type="text/javascript" src="international_airports.js"></script>
		<!-- framework css -->
		<!--[if gt IE 9]><!-->
		<link type="text/css" rel="stylesheet" href="styles/groundwork.css">
		<link type="text/css" rel="stylesheet" href="own-style.css">
		<!--<![endif]-->
		<!--[if lte IE 9]>
		<link type="text/css" rel="stylesheet" href="/css/groundwork-core.css">
		<link type="text/css" rel="stylesheet" href="/css/groundwork-type.css">
		<link type="text/css" rel="stylesheet" href="/css/groundwork-ui.css">
		<link type="text/css" rel="stylesheet" href="/css/groundwork-anim.css">
		<link type="text/css" rel="stylesheet" href="/css/groundwork-ie.css">
		<![endif]-->	
	</head>
	<script lang="javascript"> 
		
		function makeParameterText(parameter){
			var parameterText = "";
			if(parameter!=null && typeof parameter=="string"){	
				var previousCharIsUpper = false;	
				for(var i = 0 ;i < parameter.length; i++){
					if(parameter[i] == parameter[i].toUpperCase()){
						if(previousCharIsUpper)
							parameterText = parameterText + parameter[i].toUpperCase(); 
						else	
							parameterText = parameterText + " " + parameter[i].toUpperCase(); 
						previousCharIsUpper = true;
					}
					else{
						parameterText = parameterText + parameter[i]; 
						previousCharIsUpper = false;
					}				
					if(i==0)parameterText = parameter[0].toUpperCase(); 										
				}				
			}
			return parameterText;
		}
		
		function splitToTds(airlineData, headerName){			
			var keys = Object.keys(airlineData);
			var tdString = "<td class='airlineDataHeader'>"+headerName+"</td><td class='airlineDataHeader'></td>;<td class='airlineDataHeader'></td><td class='airlineDataHeader'></td>;";
			for(var i = 0; i < keys.length; i++){
				var val = airlineData[keys[i]];
				if(typeof val != 'object'){
					tdString = tdString + "<td class='parameterName'>"+ makeParameterText(keys[i]) +"</td><td class='parameterValue'>" + airlineData[keys[i]] + "</td>;";
				}
				else{				
					if(val instanceof Array){
						var flightSegments = val;
						for(var j = 0; j < flightSegments.length; j++)
							tdString = tdString + splitToTds(airlineData[keys[i]][j],"Flight Segment");
					}
					else
						tdString = tdString + splitToTds(airlineData[keys[i]],"Flight Segment");					
				}				
			}
			return tdString;
		}
		
		function tableize(airlineData){
			var tds = splitToTds(airlineData, "Boarding Pass Information");
			var airlineTable = "";
			var tdArr = tds.split(";");
			console.log(tdArr);
			var loop = 0;
			for(; loop < tdArr.length ; loop+=2){				
				var firstCol = (tdArr[loop]!="" && tdArr[loop]!=null)?tdArr[loop]:"<td>&nbsp;</td><td>&nbsp;</td>";
				var secCol 	 = (tdArr[loop+1]!="" && tdArr[loop+1]!=null)?tdArr[loop+1]:"<td>&nbsp;</td><td>&nbsp;</td>";
				console.log("F : "+firstCol)
				console.log("S : "+secCol)
				airlineTable = airlineTable + "<tr>"+ firstCol + secCol + "</tr>";
			}
			//if(loop == tdArr.length)
			airlineTable = "<table>" + airlineTable + "</table>";
			console.log(airlineTable);
			return airlineTable;
		}
		
		
	
		$('document').ready(function(){
		
			console.log(makeParameterText("secondNonConsecutiveBaggageTagLPN"));
			
		
			//var airlineCode = 'M1ALNASSER/LUBNAABDU  EM3X23F DXBISTEK 0123 033Y037C0262 366>5322MO6033BEK 0176938082002                          2A1761610270374                         30K ^1';
			var airlineCode = 'M2STONE/JACOB         EDCEZUB PERDXBEK 0421 163Y045C0221 136>20B1WW2163BEK 251762146276875 1                      DCEZUB DXBDAREK 0725 164Y041F0216 127251762146276875 1                      ';
			var airlineCodeChar = airlineCode.length;
			var bpass = BoardingPassParser.parseBoardingPass(airlineCode);
			var bdTable = tableize(bpass.parsedBoardingPassData);
			console.log(bdTable);
			console.log(JSON.stringify(bpass));
			console.log(airlineCode);
			console.log(airlineCodeChar);
			
			
			
			//$("#parsedData").text(JSON.stringify(bpass));
			document.getElementById('parsedDiv').innerHTML = bdTable;
			
			for(var i = 0; i < airlineCodeChar; i++){
				var labelElem = document.createElement("label"); 
				labelElem.setAttribute("class", "labelCell");
				labelElem.textContent  = airlineCode[i];
				document.getElementById("draw_div_one").appendChild(labelElem); 
			}
			
		});
		
		
		
		//#98ecec
	</script>
	
	<!-- <label class="airlineText">				
					M1ALNASSER/LUBNAABDU  EM3X23F DXBISTEK 0123 033Y037C0262 366>5322MO6033BEK 0176938082002                          2A1761610270374                         30K ^1
				</label> -->
	
	<body>
		
		<div class="row" style="position:relative;">			
			<div class="one eighth"></div>
			<div class="six eighths">
				
					<h4 class="box museo-slab" style='background-color:#64b084;color:#e4ea84;font-size:30px;font-weight:bold;border:0px;height:60px;line-height:40px'>Boarding Pass Information</h4>
				
					
				<textarea  rows="5" cols="100" id="airlineText" name="airlineText"  style='margin-left:5px;font-size:26px;font-weight:bold;height:200px !important;resize: none;'></textarea>		
				
				<div class="row" style="text-align:right;padding-top:10px;padding-bottom:20px">
					<a class="blue button" href="#"><i class="icon-wrench"></i> Parse</a>
				</div>	
				
				<div id="draw_div_one" class="row" style="margin-bottom:50px">
				
				</div>
				
				<div id='parsedDiv' class="row" style="padding-top:10px;padding-bottom:20px;">
					
				</div>
				
				<br>
				
				
			</div>	
			<div class="one eighth"></div>
		</div>
		<br><br>
		<div class="row">
		
		</div>
	</body>
</html>